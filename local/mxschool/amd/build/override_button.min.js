define(["jquery","core/ajax","core/notification"],function(a,b,c){function d(d){var e=a(d.target),f=e.attr("name"),g=a(".mx-override-text"+f),h=a(".mx-changeable-text"+f),i="Approved"==h.text()?"Denied":"Approved",j=h.text(),k=g.text();if(""==k&&(k="Not Overridden"),""==g.text())g.text("Under Review"),e.text("Override");else if("Under Review"==g.text())g.text("Overridden"),e.text("Undo Override"),h.text(i),"Approved"==i?h.css("color","green"):"Denied"==i&&h.css("color","red");else{if("Overridden"!=g.text())throw"Unrecognized override text: "+g.text();g.text(""),e.text("Review"),h.text(i),"Approved"==i?h.css("color","green"):"Denied"==i&&h.css("color","red")}a(".mx-comment-text"+f).text(f+" "+j+" "+k);var l=b.call([{methodname:"local_mxschool_update_healthform_override_status",args:{userid:f,status:String(j),override_status:String(k)}}]);l[0].done().fail(c.exception)}return function(b){var c=a(".mx-override-button"+b),e=a(".mx-override-text"+b),f=c.attr("value"),g=a(".mx-changeable-text"+b);if("Not Overridden"==f)e.text(""),c.text("Review");else if("Under Review"==f)e.text("Under Review"),c.text("Override");else{if("Overridden"!=f)throw"Unrecognized override_status value in database: "+f;e.text("Overridden"),c.text("Undo Override")}if("Approved"==g.text())g.css("color","green");else{if("Denied"!=g.text())throw"Should not be overriding unsubmitted form of userid: "+b;g.css("color","red")}c.click(d)}});