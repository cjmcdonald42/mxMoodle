define(["jquery","core/ajax","core/notification"],function(a,b,c){function d(d){var e=a(d.target),f=e.attr("name"),g=a(".mx-override-text"+f),h=a(".mx-changeable-textstatus"+f),i=a(".mx-changeable-textcontact_info"+f),j=a("button.mx-email-button[value='"+f+"']"),k="Approved"==h.text()?"Denied":"Approved",l=h.text(),m=g.text();if(""==m&&(m="Not Overridden"),""==g.text())i.show(),g.text("Under Review"),g.css("color","cadetblue"),e.text("Override"),e.css("background-color","lightsalmon"),e.css("border-color","lightsalmon"),j.hide();else if("Under Review"==g.text())i.hide(),g.text("Overridden"),g.css("color","lightsalmon"),e.text("Undo"),e.css("background-color","dimgray"),e.css("border-color","dimgray"),h.text(k),"Approved"==k?h.css("color","green"):"Denied"==k&&h.css("color","red"),j.show();else{if("Overridden"!=g.text())throw"Unrecognized override text: "+g.text();i.hide(),g.text(""),e.text("Review"),e.css("background-color","dodgerblue"),e.css("border-color","dodgerblue"),h.text(k),"Approved"==k?h.css("color","green"):"Denied"==k&&h.css("color","red"),j.hide()}var n=b.call([{methodname:"local_mxschool_update_healthform_override_status",args:{userid:f,status:String(l),override_status:String(m)}}]);n[0].done().fail(c.exception)}return function(b){var c=a(".mx-override-button"+b),e=a(".mx-override-text"+b),f=c.attr("value"),g=a(".mx-changeable-textstatus"+b),h=a(".mx-changeable-textcontact_info"+b),i=a("button.mx-email-button[value='"+b+"']");if("Not Overridden"==f)h.hide(),e.text(""),c.text("Review"),c.css("background-color","dodgerblue"),c.css("border-color","dodgerblue"),i.hide();else if("Under Review"==f)h.show(),e.text("Under Review"),e.css("color","cadetblue"),c.text("Override"),c.css("background-color","lightsalmon"),c.css("border-color","lightsalmon"),i.hide();else{if("Overridden"!=f)throw"Unrecognized override_status value in database: "+f;h.hide(),e.text("Overridden"),e.css("color","lightsalmon"),c.text("Undo"),c.css("background-color","dimgray"),c.css("border-color","dimgray"),i.show()}if("Approved"==g.text())g.css("color","green");else{if("Denied"!=g.text())throw"Should not be overriding unsubmitted form of userid: "+b;g.css("color","red")}c.click(d)}});