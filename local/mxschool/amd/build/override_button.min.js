define(["jquery","core/ajax","core/notification"],function(a,b,c){function d(d){var e=a(d.target),f=e.attr("name"),g=a(".mx-override-text"+f),h=a(".mx-changeable-textstatus"+f),i=a(".mx-changeable-textcontact_info"+f),j="Approved"==h.text()?"Denied":"Approved",k=h.text(),l=g.text();if(""==l&&(l="Not Overridden"),""==g.text())i.show(),g.text("Under Review"),g.css("color","cadetblue"),e.text("Override"),e.css("background-color","lightsalmon"),e.css("border-color","lightsalmon");else if("Under Review"==g.text())i.hide(),g.text("Overridden"),g.css("color","lightsalmon"),e.text("Undo"),e.css("background-color","dimgray"),e.css("border-color","dimgray"),h.text(j),"Approved"==j?h.css("color","green"):"Denied"==j&&h.css("color","red");else{if("Overridden"!=g.text())throw"Unrecognized override text: "+g.text();i.hide(),g.text(""),e.text("Review"),e.css("background-color","dodgerblue"),e.css("border-color","dodgerblue"),h.text(j),"Approved"==j?h.css("color","green"):"Denied"==j&&h.css("color","red")}var m=b.call([{methodname:"local_mxschool_update_healthform_override_status",args:{userid:f,status:String(k),override_status:String(l)}}]);m[0].done().fail(c.exception)}return function(b){var c=a(".mx-override-button"+b),e=a(".mx-override-text"+b),f=c.attr("value"),g=a(".mx-changeable-textstatus"+b),h=a(".mx-changeable-textcontact_info"+b);if("Not Overridden"==f)h.hide(),e.text(""),c.text("Review"),c.css("background-color","dodgerblue"),c.css("border-color","dodgerblue");else if("Under Review"==f)h.show(),e.text("Under Review"),e.css("color","cadetblue"),c.text("Override"),c.css("background-color","lightsalmon"),c.css("border-color","lightsalmon");else{if("Overridden"!=f)throw"Unrecognized override_status value in database: "+f;h.hide(),e.text("Overridden"),e.css("color","lightsalmon"),c.text("Undo"),c.css("background-color","dimgray"),c.css("border-color","dimgray")}if("Approved"==g.text())g.css("color","green");else{if("Denied"!=g.text())throw"Should not be overriding unsubmitted form of userid: "+b;g.css("color","red")}c.click(d)}});