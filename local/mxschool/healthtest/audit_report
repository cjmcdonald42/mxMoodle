<?php
// This file is part of Moodle - http://moodle.org/
//
// Moodle is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// Moodle is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.

/**
 * Block Report for Middlesex's Health Test system.
 *
 * @package     local_mxschool
 * @subpackage  healthtest
 * @author      Cannon Caspar, Class of 2021 <cpcaspar@mxschool.edu>
 * @author      Charles J McDonald, Academic Technology Specialist <cjmcdonald@mxschool.edu>
 * @copyright   2021 Middlesex School, 1400 Lowell Rd, Concord MA 01742 All Rights Reserved.
 * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */

require(__DIR__.'/../../../config.php');
require_once(__DIR__.'/../locallib.php');

// 1. is the user signed into moodle
require_login();

//2. does the user have the capability to view and manage healthtest data
require_capability('local/mxschool:manage_healthpass', context_system::instance());

//3. Create an array of userIDs for every user with the capability to access the COVIDtest subsystem.
$healthtest_users = array();
$users = get_user_list();
foreach ($users as $value)
{
    if($value.has_capability('local/mxschool:access_healthtest', context_system::instance())
    {
        array_push($covidtest_users, $value);
    }
}





/*$testing_cycle_list = .get_testing_cycle_list();
foreach ($healthtest_users as $user)
{
    foreach ($testing_cycle_list as $list)
    {
        if($user.) // needs if user attended the covid test during the current list
        {
            if(!$list.isempty())
            {
                array_push($list, ", ");
            }
            array_push($list, $list.get_current_testing_cycle()))//need a date inside the method
        }
    }


}
*/
